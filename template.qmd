---
# ------------------------------------------------------------------
# EXAMPLE DOCUMENT FOR THE 'academiccvtemplate-typst' EXTENSION
#
# This document demonstrates how to use the Quarto extension to
# create a data-driven CV. All metadata and styling is set
# here in the YAML header, and the content is loaded from R.
# ------------------------------------------------------------------

# -- Basic Document Information ------------------------------------
title: "Documents of Application"
author:
  firstname: "Your Firstname"
  lastname: "Your Lastname"
  contact:
    - icon: fa address-card
      text: "Your Address"
    - icon: fa mobile-screen
      text: "Your Phone Number"
    - icon: fa envelope
      text: "Your E-Mail-Address"
      url: "mailto:your.email@gmail.com"
  socialmedia:
    - icon: fa house
      text: example.com
      url: https://example.com
    - icon: fa orcid
      text: "Your Orcid Number"
      url: "Link To Your Orcid Page"
    - icon: fa github
      text: "Your GitHub Page"
      url: "Link To Your GitHub Page"
    - icon: fa linkedin
      text: "LinkedIn"
      url: "Link To Your LinkedIn Account"

# -- Cover Letter Information --------------------------------------
recipient:
  name: "A Name"
  salutation: "Salutation"
  address: "Oxmoron Street"
  city: "The City"
  zip: "66696"
date: "1. March 2025"
subject: "The subject of the cover letter"

# -- Core CV Content -----------------------------------------------
# These fields provide main content blocks to the template.
position: "Your Position" # Either your current position or the position you are applying for
aboutme: |
  Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy 
  eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam 
  voluptua. At vero eos et accusam et justo duo dolores et ea rebum.
famous-quote: # Optional
  text: "Nothing is as practical as a good theory."
  attribution: "Kurt Lewin"

# -- Template Styling ----------------------------------------------
# These variables override the template defaults.
style:
  color-accent: "5e81ac" # A custom accent color (e.g., from Nord palette)
  font-header: "Lato"
  font-text: "Roboto"

profile-photo: ""
# -- Output Options ------------------------------------------------
render-output: "combined" # "cv-only", "letter-only", or "combined"

# -- Format Activation ---------------------------------------------
# This is the most important line:
# It tells Quarto to use your custom Typst format.
format: academiccvtemplate-typst
---

## Coverletter

Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.

```{r}
#| label: lst-setup
#| include: false

# Load required libraries
library(tidyverse)       # For data manipulation (pipes, dplyr)
library(googledrive)     # To find the Google Sheet by name
library(googlesheets4)   # To read the Google Sheet data
library(academicCVtools) # The extension's R helper package

# --- Authentication -----------------------------------------------
# You must authenticate with Google to allow R to access your private sheets.
# This will open a browser window for you to log in the first time.
drive_auth()
gs4_auth(token = drive_token())

# --- Sheet Selection ----------------------------------------------
# Define which tabs (sheets) you want to load from your Google Sheet.
# The names here MUST match the tab names in your Google Sheet exactly.
cv_sheets_list <- list(
  "Working Experiences",
  "Education",
  "IT Skills", 
  "Language Skills",
  # You can rename a sheet if needed, e.g.:
  # "Raised Fundings" = "funds", 
  "Reviewer",
  "Institutional Services",
  "Research Interests",
  "Additional Academic Activity",
  "Teaching Experiences",
  "Training and Professional Development",
  "Other Employments",
  "Social Engagement",
  "Internships"
)

# --- Data Loading -------------------------------------------------
# The `load_cv_sheets` function finds your sheet and loads all the tabs
# defined in `cv_sheets_list` into a single R list named `cv_sheets`.
cv_sheets <- load_cv_sheets(
  # The name of your Google Sheet (must be unique in your Drive)
  doc_identifier = "Application_CV_Data", 
  
  # Use the list defined above.
  # Alternatively, use "*" to load ALL tabs from the sheet.
  sheets_to_load = cv_sheets_list 
)
```

## Research Interests

```{r}
#| output: asis
#| label: lst-research_interests

cv_sheets$research_interests |> 
  format_typst_section(
    # The name of the Typst function to call in your template
    typst_func = "#research-interests"
  ) |> 
  cat()
```

## Working Experiences

```{r}
#| output: asis
#| label: lst-work

cv_sheets$working_experiences |>
  format_typst_section(
    typst_func = "#resume-entry",
    
    # --- Data Combination ---
    # This is a powerful feature:
    # It finds all columns starting with "detail" (e.g., detail1, detail2)
    # and combines them into a single list column...
    combine_cols = c(dplyr::starts_with("detail")),
    # ...named "details".
    combine_as = "details",
    # This separator is added *between* combined items
    combine_sep = "\\ \\ ", # A Typst line break
    # This prefix is added *before* each item
    combine_prefix = "Â· ",
    
    # --- Column Exclusion ---
    # Exclude columns from the Google Sheet that the Typst function
    # doesn't need (e.g., sorting columns).
    exclude_cols = c(start, end)
  ) |> cat()
```

